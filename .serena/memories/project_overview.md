# Telegram商户机器人 V2.0 项目概览

## 项目目标
一个现代化的Telegram营销机器人系统，专为服务型业务设计，支持商户管理、用户预约、订单处理和完整的Web管理后台。

## 核心架构
- **Python 3.12+** - 现代Python特性支持
- **aiogram 3.4.1** - 异步Telegram机器人框架，支持FSM状态管理
- **FastHTML** - Web管理后台框架
- **SQLite** - 轻量级数据库，支持异步操作
- **APScheduler** - 定时任务调度器
- **Railway** - 云平台部署

## 核心业务流程（5阶段）
1. **阶段一**: 商户通过付款机器人获得绑定码
2. **阶段二**: 商户用`/bind <绑定码>`绑定，FSM状态机引导填写信息
3. **阶段三**: 管理员在Web后台审核，可修改信息并设置到期时间
4. **阶段四**: 定时任务服务在指定时间自动发布到频道
5. **阶段五**: 商户通过`/panel`查看状态，用户可下单评价

## 永久ID系统
- **核心价值**: 解决商户更换Telegram账号导致数据丢失的问题
- **设计理念**: merchants表的id字段是永久ID，telegram_chat_id可以修改
- **业务保障**: 所有业务数据都关联到永久ID，不关联TG账号

## 项目结构
- `main.py` - 生产环境ASGI入口
- `run.py` - 开发环境启动脚本
- `bot.py` - Telegram机器人主类
- `config.py` - 项目配置和消息模板
- `web/` - Web管理后台（14个功能模块）
- `database/` - 数据库层管理器
- `handlers/` - 机器人处理器
- `scripts/` - 工具脚本（包括迁移脚本）

## 当前状态
V2.0重构已完成，系统处于生产就绪状态。采用ASGI统一架构，支持多模式启动，具备完整的Web管理后台和14个功能模块。