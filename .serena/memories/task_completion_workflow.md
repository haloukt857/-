# 任务完成工作流程

## 编写代码后必须执行的步骤

### 1. 代码质量检查
```bash
# 格式化代码
black .

# 检查代码风格
flake8 .

# 类型检查
mypy .
```

### 2. 测试执行
```bash
# 运行相关测试
python run_tests.py

# 或者运行特定测试
pytest tests/unit/test_merchants.py -v
pytest tests/integration/ -v
```

### 3. 数据库迁移（如果有数据库修改）
```bash
# 重要：这是修改数据库结构的唯一正确方式
python scripts/migrate_to_v2.py
```

### 4. 功能验证
- 启动应用：`python run.py`
- 访问Web管理后台：http://127.0.0.1:8007
- 测试新增/修改的功能
- 检查日志输出是否正常

### 5. Git提交（如果代码改动满意）
```bash
git status
git add .
git diff --staged  # 检查将要提交的更改
git commit -m "具体描述性的提交信息"
# 注意：除非明确要求，否则不要push
```

## Web管理后台功能验证清单
当开发Web功能时，确保：
- [ ] 页面正常加载，无500错误
- [ ] 所有CRUD操作功能正常
- [ ] 表单验证工作正确
- [ ] 错误处理友好
- [ ] 响应式设计在不同屏幕尺寸下正常

## 重要注意事项
1. **数据库修改**：绝对不能直接修改数据库文件，必须通过迁移脚本
2. **测试覆盖**：新功能必须有对应的测试用例
3. **错误处理**：所有可能出错的地方都要有适当的异常处理
4. **日志记录**：重要操作都要记录适当的日志
5. **安全性**：Web路由要有认证保护，不要暴露敏感信息