# Web管理后台功能完整说明 (V2.0)

## 项目概述

新版Web管理后台是Telegram商户机器人系统的**指挥中心**。它为管理员提供了两大核心功能的管理界面：
1.  **商户与帖子管理**: 负责商户从提交信息、审核、批准到最终发布和过期下线的全生命周期。
2.  **订单管理**: 负责追踪和管理普通用户对商户服务的预约记录。

后台基于FastHTML框架构建，与机器人和后端服务实时同步数据。

## 功能模块详细说明

### 1. 认证与权限管理
(功能不变)
- **登录系统**: 基于密码的单一管理员认证。
- **会话管理**: 自动超时和手动登出功能。

### 2. 仪表板 - 核心指标监控
仪表板提供系统两大核心功能的状态快照。

#### 核心统计数据
- **待审批帖子**: 等待管理员审核的商户信息数量。
- **今日新增订单**: 当天产生的用户预约数量。
- **活跃帖子总数**: 当前在有效期内的已发布帖子总数。
- **订单总数**: 系统累计的预约订单总量。

### 3. 商家管理 - **核心信息索引模块**

此模块专注于快速查找和索引商户。

- **列表与搜索**: 页面以简洁列表形式展示所有商户的`永久ID`和`名称`，并提供一个高效的搜索框，支持通过名称快速定位到特定商户。
- **只读详情页**: 点击商户名称，可以跳转到该商户的详情页，此页面**只读不改**，包含：
    - 该商户最近发布的帖子内容、发布时间和服务到期时间。
    - 一个自动生成的Telegram深度链接（例如 `https://t.me/xiaojisystembot?start=merchant_18`），方便管理员直接跳转到Bot中查看该商户。
- **未来扩展**: 此页面将作为入口，用于查看该商户的**评价信息**（综合评分、评价列表等）。

### 4. 帖子管理 - **核心发布控制模块**

此模块是管理员日常操作最频繁的区域，专注于帖子的审核与发布控制。

- **列表与视图**: 默认按时间倒序展示最近的帖子（如30条），并可筛选“待发布”或“已发布”的帖子。
- **详情与修改**: 点击帖子可进入编辑页面，管理员可以修改帖子的所有内容。
- **发布控制**: 管理员在此处可以执行多项操作：
    - **手动批准**: 将待审核的帖子批准为“待发布”。
    - **修改发布时间**: 调整帖子的预定发布时间。
    - **修改服务到期时间**: 延长或缩短该帖子的服务周期。
    - **暂停发布**: （新增功能）可以暂时将一个“待发布”的帖子挂起，使其不会被自动发布。

### 5. 订单管理 - **核心交易记录模块**

此模块负责追踪普通用户看到帖子后产生的服务预约记录。

#### 订单列表与筛选
- **订单数据**: 列表按时间倒序展示最近的订单（如50个），并以下表格式清晰呈现：

| 订单ID | 老师/商户名称 | 用户 | 类型 | 状态 | 价格 | 预约时间 | 评价状态 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 19 | 曼曼 | @Vicentia888 | PP | 尝试预约 | ¥800 | 2025-09-08 15:36 | 待商家确认 |
| 18 | 莉莉 | @user123 | P | 已完成 | ¥1200 | 2025-09-08 14:20 | 已完成 |

- **状态说明**: “状态”字段包括：`尝试预约`, `已完成`, `已评价`, `双方评价`, `单方评价`。
- **评价状态说明**: “评价状态”字段包括：`无评价`, `待商家确认`, `已完成`。
- **多维度筛选**: 支持按商户、按日期、按订单状态进行组合筛选，方便管理员查询。

#### 订单详情
- **完整信息**: 提供订单的全部详细信息，包括用户的Telegram信息、商户信息、价格、各项时间戳等。
- **状态跟踪**: 清晰地展示订单当前是“待处理”、“已确认”、“已完成”还是“已取消”。
- **评价跟踪**: 显示该笔订单后续是否已完成评价（为未来的评价系统做准备）。

### 6. 绑定码管理 - 商户接入控制

此模块是商户进入自动化上榜流程的入口。

- **批量生成**: 管理员可点击按钮，按需批量生成绑定码（如一次30个或50个）。
- **状态跟踪**: 列表清晰显示每个绑定码、使用状态、绑定者（Telegram名称和用户名）以及绑定时间。
- **管理操作**: 支持复制、删除未使用的绑定码等。

### 7. 用户激励系统管理

此区域用于配置独立的**用户**激励体系。

- **等级管理**: 管理员可在此设定不同的用户等级（如名称、所需经验值）。
- **勋章管理**: 管理员可创建和编辑不同的勋章及其触发条件。
- **积分配置**: 管理员可配置完成不同动作（如按钮评价、文字评价）所获得的积分/经验值。
	
## 管理员核心工作流程

管理员日常有两条主要工作流：

**工作流A：审核新帖子**
1.  在“帖子管理”页面，筛选出所有“待审批”的帖子。
2.  逐个审核内容，进行必要的修改，并设定好到期时间。媒体文件通过“机器人代理”模式实时加载，无需额外存储。
3.  点击“批准发布”，完成审核。

**工作流B：查看订单情况**
1.  在“订单管理”页面，查看每日新增的订单。
2.  根据需要，按商户或日期筛选订单，了解特定商户的业务情况。
3.  跟进异常状态的订单。
