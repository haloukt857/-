# 帖子管理模块技术文档 (V2.0)

## 🚨 商户ID统一标准 (引用绑定码模块)

### 帖子-商户关联方法
```python
# ✅ 帖子管理中的商户ID标准
# 所有帖子通过 merchant_id 关联商户永久ID
post_data = {
    'merchant_id': merchant_id,  # 商户永久ID，来自merchants.id
    'status': 'pending_approval',
    'publish_time': datetime,
    'expiration_time': datetime
}

# 查询商户的所有帖子
from database.db_merchants import merchants_manager
posts = await merchants_manager.get_merchant_posts(merchant_id)
```

### 状态驱动的生命周期
```python
# 帖子状态标准流程
VALID_STATUSES = [
    'pending_submission',  # 商户信息收集中
    'pending_approval',    # 等待管理员审核
    'approved',           # 已审核，等待发布
    'published',          # 已发布
    'expired'             # 已过期
]
```

---

## 模块概述

本模块是Web管理后台的核心操作区域，管理员在此对所有帖子的生命周期进行全面的控制，从审核、修改到发布和暂停。

### 业务价值
- 实现对发布内容的完全控制和质量把关。
- 提供灵活的发布调度能力。
- 确保所有上线内容的准确性和时效性。

---

## 核心功能

### 1. 帖子列表与筛选
- **功能**: 默认按创建时间倒序，展示最近的帖子列表（例如30条），清晰地标明每个帖子的状态。
- **交互**: 提供状态筛选功能，方便管理员快速查看“待发布”、“已发布”等不同状态的帖子。

### 2. 详情与修改
- **功能**: 点击任意帖子，可以进入其详情编辑页面。
- **交互**: 管理员在此页面拥有完全的编辑权限，可以修改帖子的所有文本内容、图片等信息。

### 3. 发布控制
这是本模块最核心的功能，管理员可以执行一系列精细化的发布操作：

- **手动批准**: 对于新提交的、处于“待审核”状态的帖子，管理员在检查无误后，可点击按钮将其批准为“待发布”状态。
- **修改发布时间**: 灵活调整帖子的预定发布时间。
- **修改服务到期时间**: 延长或缩短该帖子的线上服务周期。
- **暂停发布**: 对于一个已经“待发布”但暂时不想让它上线的帖子，可以将其“暂停”，这样后台的自动发布服务将跳过该帖，直至管理员手动恢复。
